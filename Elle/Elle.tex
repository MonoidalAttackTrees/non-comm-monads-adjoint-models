\documentclass[11pt]{article}
\usepackage{amsmath,amssymb}
\usepackage{supertabular}
\usepackage{cmll}
\usepackage{txfonts}
\usepackage{color}
\usepackage{tikz}
\usepackage{mathpartir}

\newcommand\encircle[1]{%
  \tikz[baseline=(X.base)] 
    \node (X) [draw, shape=circle, inner sep=-1.5pt] {\strut #1};}

\newcommand{\circop}[1]{\mathop{\encircle{#1}}}


\input{Elle-ott}

\begin{document}

Deriving exchange in Elle comonadicly:

\begin{center}
  \tiny
  \begin{math}
    $$\mprset{flushleft}
    \inferrule* [right={\tiny imprR}] {
      $$\mprset{flushleft}
    \inferrule* [right={\tiny tenL}] {
      $$\mprset{flushleft}
    \inferrule* [right={\tiny Fl}] {
      $$\mprset{flushleft}
      \inferrule* [right={\tiny Fl}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny beta}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny tenR}] {
            $$\mprset{flushleft}
            \inferrule* [right={\tiny Fr}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny ax}] {
                \,
              }{[[y0 : Gf B |-c y0 : Gf B]]}
            }{[[y0 : Gf B |-l F y0 : F Gf B]]}
            \\
            $$\mprset{flushleft}
            \inferrule* [right={\tiny Fr}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny ax}] {
                \,
              }{[[x0 : Gf A |-c x0 : Gf A]]}
            }{[[x0 : Gf A |-l F x0 : F Gf A]]}
          }{[[y0 : Gf B, x0 : Gf A |-l h(F y0) (>) F x0 : h(F Gf B) (>) F Gf A]]}
        }{[[x1 : Gf A, y1 : Gf B |-l ex y1 , x1 with y0 , x0 in (h(F y0) (>) F x0) : h(F Gf B) (>) F Gf A]]}
      }{[[x1 : Gf A , y2 : F Gf B |-l let y2 : F Gf B be F y1 in (ex y1 , x1 with y0 , x0 in (h(F y0) (>) F x0)) : h(F Gf B) (>) F Gf A]]}
    }{[[x2 : F Gf A, y2 : F Gf B |-l let x2 : F Gf A be F x1 in (let y2 : F Gf B be F y1 in (ex y1 , x1 with y0 , x0 in (h(F y0) (>) F x0))) : h(F Gf B) (>) F Gf A]]}
    }{[[z : h(F Gf A) (>) F Gf B |-l let z : h(F Gf A) (>) F Gf B be x2 (>) y2 in (let x2 : F Gf A be F x1 in (let y2 : F Gf B be F y1 in (ex y1 , x1 with y0 , x0 in (h(F y0) (>) F x0)))) : (h(F Gf B) (>) F Gf A)]]}
    }{[[. |-l \r z : h(F Gf A) (>) F Gf B . let z : h(F Gf A) (>) F Gf B be x2 (>) y2 in (let x2 : F Gf A be F x1 in (let y2 : F Gf B be F y1 in (ex y1 , x1 with y0 , x0 in (h(F y0) (>) F x0)))) : (h(F Gf A) (>) F Gf B) -> (h(F Gf B) (>) F Gf A)]]}
  \end{math}
\end{center}



Deriving right contraction in Elle comonadicly:
\begin{center}
  \tiny
  \begin{math}
    $$\mprset{flushleft}
    \inferrule* [right={\tiny imprR}] {
      $$\mprset{flushleft}
      \inferrule* [right={\tiny tenL}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny Fl}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny Fl}] {
            $$\mprset{flushleft}
            \inferrule* [right={\tiny contrR}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny tenR}] {
                $$\mprset{flushleft}
                \inferrule* [right={\tiny Fr}] {
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny ax}] {
                    \,
                  }{[[x1 : Gf A |-c x1 : Gf A]]}
                }{[[x1 : Gf A |-l F x1 : F Gf A]]}
                \\
                \inferrule* [right={\tiny tenR}] {
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny Fr}] {
                    $$\mprset{flushleft}
                    \inferrule* [right={\tiny ax}] {
                      \,
                    }{[[y0 : Gf B |-c y0 : Gf B]]}
                  }{[[y0 : Gf B |-l F y0 : F Gf B]]}
                  \\
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny Fr}] {
                    $$\mprset{flushleft}
                    \inferrule* [right={\tiny ax}] {
                      \,
                    }{[[x0 : Gf A |-c x0 : Gf A]]}
                  }{[[x0 : Gf A |-l F x0 : F Gf A]]}
                }{[[y0 : Gf B, x0 : Gf A |-l h(F y0) (>) F x0 : h(F Gf B) (>) F Gf A]]}
              }{[[x1 : Gf A, y0 : Gf B, x0 : Gf A |-l h(F x1) (>) (h(F y0) (>) F x0) : h(F Gf A) (>) (h(F Gf B) (>) F Gf A)]]}
            }{[[y0 : Gf B, x2 : Gf A |-l contrR x2 as x1, x0 in (h(F x1) (>) (h(F y0) (>) F x0)) : h(F Gf A) (>) (h(F Gf B) (>) F Gf A)]]}
          }{[[y0 : Gf B , x3 : F Gf A |-l let x3 : F Gf A be F x2 in (contrR x2 as x1, x0 in (h(F x1) (>) (h(F y0) (>) F x0))) : h(F Gf A) (>) (h(F Gf B) (>) F Gf A)]]}
        }{[[y1 : F Gf B, x3 : F Gf A |-l let y1 : F Gf B be F y0 in (let x3 : F Gf A be F x2 in (contrR x2 as x1, x0 in (h(F x1) (>) (h(F y0) (>) F x0)))) : h(F Gf A) (>) (h(F Gf B) (>) F Gf A)]]}
      }{[[z : h(F Gf B) (>) F Gf A |-l let z : h(F Gf B) (>) F Gf A be y1 (>) x3 in (let y1 : F Gf B be F y0 in (let x3 : F Gf A be F x2 in (contrR x2 as x1, x0 in (h(F x1) (>) (h(F y0) (>) F x0))))) : h(F Gf A) (>) (h(F Gf B) (>) F Gf A)]]}
    }{[[. |-l \r z : h(F Gf B) (>) F Gf A . let z : h(F Gf B) (>) F Gf A be y1 (>) x3 in (let y1 : F Gf B be F y0 in (let x3 : F Gf A be F x2 in (contrR x2 as x1, x0 in (h(F x1) (>) (h(F y0) (>) F x0))))) : (h(F Gf B) (>) F Gf A) -> (h(F Gf A) (>) (h(F Gf B) (>) F Gf A))]]}
  \end{math}
\end{center}



Deriving left contraction in Elle comonadicly:
\begin{center}
  \tiny
  \begin{math}
    $$\mprset{flushleft}
    \inferrule* [right={\tiny imprR}] {
      $$\mprset{flushleft}
      \inferrule* [right={\tiny tenL}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny Fl}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny Fl}] {
            $$\mprset{flushleft}
            \inferrule* [right={\tiny contrR}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny tenR}] {
                $$\mprset{flushleft}
                \inferrule* [right={\tiny tenR}] {
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny Fr}] {
                    $$\mprset{flushleft}
                    \inferrule* [right={\tiny ax}] {
                      \,
                    }{[[x0 : Gf A |-c x0 : Gf A]]}
                  }{[[x0 : Gf A |-l F x0 : F Gf A]]}
                  \\
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny Fr}] {
                    $$\mprset{flushleft}
                    \inferrule* [right={\tiny ax}] {
                      \,
                    }{[[y0 : Gf B |-c y0 : Gf B]]}
                  }{[[y0 : Gf B |-l F y0 : F Gf B]]}
                }{[[x0 : Gf A, y0 : Gf B |-l h(F x0) (>) F y0 : h(F Gf A) (>) F Gf B]]}
                \\
                \inferrule* [right={\tiny Fr}] {
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny ax}] {
                    \,
                  }{[[x1 : Gf A |-c x1 : Gf A]]}
                }{[[x1 : Gf A |-l F x1 : F Gf A]]}
              }{[[x0 : Gf A, y0 : Gf B, x1 : Gf A |-l (h(F x0) (>) F y0) (>) F x1 : (h(F Gf A) (>) F Gf B) (>) F Gf A]]}
            }{[[x2 : Gf A, y0 : Gf B |-l contrL x2 as x0, x1 in ((h(F x0) (>) F y0) (>) F x1) : (h(F Gf A) (>) F Gf B) (>) F Gf A]]}
          }{[[x2 : Gf A , y1 : F Gf B |-l let y1 : F Gf B be F y0 in (contrL x2 as x0, x1 in ((h(F x0) (>) F y0) (>) F x1)) : (h(F Gf A) (>) F Gf B) (>) F Gf A]]}
        }{[[x3 : F Gf A, y1 : F Gf B |-l let x3 : F Gf A be F x2 in (let y1 : F Gf B be F y0 in (contrL x2 as x0, x1 in ((h(F x0) (>) F y0) (>) F x1))) : (h(F Gf A) (>) F Gf B) (>) F Gf A]]}
      }{[[z : h(F Gf A) (>) F Gf B |-l let z : h(F Gf A) (>) F Gf B be x3 (>) y1 in (let x3 : F Gf A be F x2 in (let y1 : F Gf B be F y0 in (contrL x2 as x0, x1 in ((h(F x0) (>) F y0) (>) F x1)))) : (h(F Gf A) (>) F Gf B) (>) F Gf A]]}
    }{[[. |-l \r z : h(F Gf A) (>) F Gf B . let z : h(F Gf A) (>) F Gf B be x3 (>) y1 in (let x3 : F Gf A be F x3 in (let y1 : F Gf B be F y0 in (contrL x2 as x0, x1 in (h(F x0) (>) (h(F y0) (>) F x1))))) : (h(F Gf A) (>) F Gf B) -> ((h(F Gf A) (>) F Gf B) (>) F Gf A)]]}
  \end{math}
\end{center}



Deriving weakening in Elle comonadicly:
\begin{center}
  \tiny
  \begin{math}
    $$\mprset{flushleft}
    \inferrule* [right={\tiny imprR}] {
      $$\mprset{flushleft}
      \inferrule* [right={\tiny Fl}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny weak}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny unitR}] {
            \,
          }{[[. |-l trivS : UnitS]]}
        }{[[x0 : Gf A |-l weak x0 in trivS : UnitS]]}
      }{[[x1 : F Gf A |-l let x1 : F Gf A be F x0 in weak x0 in trivS : UnitS]]}
    }{[[. |-l \r x1 : F Gf A . let x1 : F Gf A be F x0 in weak x0 in trivS : (F Gf A) -> (UnitS)]]}
  \end{math}
\end{center}

$GF$ is a monad:
\begin{itemize}
\item Deriving $\eta$:
  \begin{center}
    \tiny
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right={\tiny imprR}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny Gr}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny Gl}] {
            $$\mprset{flushleft}
            \inferrule* [right={\tiny Fl}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny Gl}] {
                $$\mprset{flushleft}
                \inferrule* [right={\tiny ax}] {
                  \,
                }{[[x0 : F X |-l x0 : F X]]}
              }{[[x1 : Gf F X |-l let x1 : Gf F X be Gf x0 in x0 : F X]]}
            }{[[x2 : F Gf F X |-l let x2 : F Gf F X be F x1 in (let x1 : Gf F X be Gf x0 in x0) : F X]]}
          }{[[x3 : Gf F Gf F X |-l let x3 : Gf F Gf F X be Gf x2 in (let x2 : F Gf F X be F x1 in (let x1 : Gf F X be Gf x0 in x0)) : F X]]}
        }{[[x3 : Gf F Gf F X |-c Gf (let x3 : Gf F Gf F X be Gf x2 in (let x2 : F Gf F X be F x1 in (let x1 : Gf F X be Gf x0 in x0))) : Gf F X]]}
      }{[[ . |-c \ x3 : Gf F Gf F X . Gf (let x3 : Gf F Gf F X be Gf x2 in (let x2 : F Gf F X be F x1 in (let x1 : Gf F X be Gf x0 in x0))) : (Gf F Gf F X) -o (Gf F X)]]}
    \end{math}
  \end{center}
\item Deriving $\mu$:
  \begin{center}
    \tiny
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right={\tiny imprR}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny Gr}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny Fr}] {
            $$\mprset{flushleft}
            \inferrule* [right={\tiny ax}] {
              \,
            }{[[x : X |-c x : X]]}
          }{[[x : X |-l F x : F X]]} 
        }{[[x : X |-c Gf F x : Gf F X]]}
      }{[[. |-c \ x : X . Gf F x : (X) -o (Gf F X)]]}
    \end{math}
  \end{center}
\end{itemize}

The monad $GF$ is strong:
\begin{itemize}
\item Deriving the tensorial strength $\tau$:
  \begin{center}
    \tiny
    \begin{math}
      $$\mprset{flushleft}
      \inferrule* [right={\tiny imprR}] {
        $$\mprset{flushleft}
        \inferrule* [right={\tiny tenL}] {
          $$\mprset{flushleft}
          \inferrule* [right={\tiny beta}] {
            $$\mprset{flushleft}
            \inferrule* [right={\tiny Gr}] {
              $$\mprset{flushleft}
              \inferrule* [right={\tiny Gl}] {
                $$\mprset{flushleft}
                \inferrule* [right={\tiny Fl}] {
                  $$\mprset{flushleft}
                  \inferrule* [right={\tiny Fr}] {
                    $$\mprset{flushleft}
                    \inferrule* [right={\tiny tenR}] {
                      $$\mprset{flushleft}
                      \inferrule* [right={\tiny ax}] {
                        \,
                      }{[[x0 : X |-c x0 : X]]}
                      $$\mprset{flushleft}
                      \inferrule* [right={\tiny ax}] {
                        \,
                      }{[[y0 : Y |-c y0 : Y]]}
                    }{[[x0 : X , y0 : Y |-c x0 (x) y0 : h(X) (x) Y]]}
                  }{[[x0 : X , y0 : Y |-l F (x0 (x) y0) : F (h(X) (x) Y)]]}
                }{[[x0 : X , y1 : F Y |-l let y1 : F Y be F y0 in F (x0 (x) y0) : F (h(X) (x) Y)]]}
              }{[[y2 : Gf F Y , x0 : X |-l let y2 : Gf F Y be Gf y1 in (let y1 : F Y be F y0 in F (x0 (x) y0)) : F (h(X) (x) Y)]]}
            }{[[y2 : Gf F Y , x0 : X |-c Gf (let y2 : Gf F Y be Gf y1 in (let y1 : F Y be F y0 in F (x0 (x) y0))) : Gf F (h(X) (x) Y)]]}
          }{[[x1 : X , y3 : Gf F Y |-c ex y3 , x1 with y2 , x0 in (Gf (let y2 : Gf F Y be Gf y1 in (let y1 : F Y be F y0 in F (x0 (x) y0)))) : Gf F (h(X) (x) Y)]]}
        }{[[z : h(X) (x) Gf F Y |-c let z : h(X) (x) Gf F Y be x1 (x) y3 in (ex y3 , x1 with y2 , x0 in (Gf (let y2 : Gf F Y be Gf y1 in (let y1 : F Y be F y0 in F (x0 (x) y0))))) : Gf F (h(X) (x) Y)]]}
      }{[[. |-c \ z : h(X) (x) Gf F Y . let z : h(X) (x) Gf F Y be x1 (x) y3 in (ex y3 , x1 with y2 , x0 in (Gf (let y2 : Gf F Y be Gf y1 in (let y1 : F Y be F y0 in F (x0 (x) y0))))) : (h(X) (x) Gf F Y) -o (Gf F (h(X) (x) Y))]]}
    \end{math}
  \end{center}
\end{itemize}


\appendix

\section{Full Ott Spec}
\label{sec:full_ott_spec}
\footnotesize
\ottall
% section full_ott_spec (end)

\end{document}
